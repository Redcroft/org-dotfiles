#+TITLE: Nvidia Config
#+AUTHOR: Richard Redcroft
#+EMAIL: Richard@Redcroft.tech
#+OPTIONS: toc:nil num:nil
#+PROPERTY: Header-args :tangle-mode (identity #o444) :mkdirp yes
#+auto_tangle: t

#+begin_src conf :tangle (if (string= system-name "heimdall") "/sudo::/etc/systemd/system/gpu-limit.service" "")
  [Service]
  Type=oneshot
  User=root
  ExecStart=/usr/bin/nvidia-smi -i 0 -pl 400
  RemainAfterExit=yes

  [Install]
  WantedBy=multi-user.target
#+end_src

#+begin_src sh :tangle no :results none
  sudo systemctl enable --now gpu-limit
  sudo systemctl enable --now nvidia-persistenced
#+end_src
